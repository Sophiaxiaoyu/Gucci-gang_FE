(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[6],{104:function(e,t,a){"use strict";var r=a(21),n=a(25),s=a(8),c=function(){function e(){Object(r.a)(this,e)}return Object(n.a)(e,[{key:"createOrder",value:function(e,t,a,r){return s.a.post("/orders/create",{amount:e,itemTotal:t,ref:a,paymentMethod:r})}},{key:"getAllOrders",value:function(e){return s.a.get("/orders/?page=".concat(e))}},{key:"getOrder",value:function(e){return s.a.get("/orders/".concat(e))}}]),e}();t.a=new c},117:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a(5),s=a(18),c=a(1),l=a(2),i=a(17),d=a(26),o=a(13),u=function(e){var t=e.next,a=Object(i.b)().userData,n=Object(d.a)(),s=n.register,u=n.handleSubmit,b=n.errors,j=n.setValue;return Object(c.useEffect)((function(){j("fullname",null===a||void 0===a?void 0:a.fullname),j("email",null===a||void 0===a?void 0:a.email),j("address",null===a||void 0===a?void 0:a.address),j("country",null===a||void 0===a?void 0:a.country),j("city",null===a||void 0===a?void 0:a.city),j("state",null===a||void 0===a?void 0:a.state)}),[j,a]),Object(r.jsxs)("div",{className:"w-full",children:[Object(r.jsx)("h1",{className:"text-3xl text-center mb-4 font-semibold",children:"Address Details"}),Object(r.jsxs)("form",{className:"border p-4 border-black-4 w-full md:w-1/2 mx-auto",onSubmit:u((function(e){return t(e)})),children:[Object(r.jsxs)(l.Label,{className:"block text-grey-darker text-sm font-bold mb-4",children:[Object(r.jsx)("span",{children:"Fullname"}),Object(r.jsx)(l.Input,{disabled:!0,type:"text",className:"shadow appearance-none border rounded w-full text-grey-darker mt-2 px-2 py-2 border focus:outline-none",name:"fullname",ref:s({required:"Required"})}),b.fullname&&Object(r.jsx)(l.HelperText,{valid:!1,children:b.fullname.message})]}),Object(r.jsxs)(l.Label,{className:"block text-grey-darker text-sm font-bold mb-4",children:[Object(r.jsx)("span",{children:"Email"}),Object(r.jsx)(l.Input,{disabled:!0,className:"shadow appearance-none border rounded w-full text-grey-darker mt-2 px-2 py-2 border focus:outline-none",type:"text",name:"email",ref:s({required:"Required"})}),b.email&&Object(r.jsx)(l.HelperText,{valid:!1,children:b.email.message})]}),Object(r.jsxs)(l.Label,{className:"block text-grey-darker text-sm font-bold mb-4",children:[Object(r.jsx)("span",{children:"Address"}),Object(r.jsx)(l.Input,{className:"shadow appearance-none border rounded w-full py-2 px-3 text-grey-darker mt-2 px-2 py-2 border focus:outline-none",type:"text",name:"address",ref:s({required:"Required"})}),b.address&&Object(r.jsx)(l.HelperText,{valid:!1,children:b.address.message})]}),Object(r.jsxs)(l.Label,{className:"block text-grey-darker text-sm font-bold mb-4",children:[Object(r.jsx)("span",{children:"Country"}),Object(r.jsx)(l.Input,{className:"shadow appearance-none border rounded w-full py-2 px-3 text-grey-darker mt-2 px-2 py-2 border focus:outline-none",type:"text",name:"country",ref:s({required:"Required"})}),b.country&&Object(r.jsx)(l.HelperText,{valid:!1,children:b.country.message})]}),Object(r.jsxs)(l.Label,{className:"block text-grey-darker text-sm font-bold mb-4",children:[Object(r.jsx)("span",{children:"State/Region"}),Object(r.jsx)(l.Input,{className:"shadow appearance-none border rounded w-full py-2 px-3 text-grey-darker mt-2 px-2 py-2 border focus:outline-none",type:"text",name:"state",ref:s({required:"Required"})}),b.state&&Object(r.jsx)(l.HelperText,{valid:!1,children:b.state.message})]}),Object(r.jsxs)(l.Label,{className:"block text-grey-darker text-sm font-bold mb-4",children:[Object(r.jsx)("span",{children:"City"}),Object(r.jsx)(l.Input,{className:"shadow appearance-none border rounded w-full text-grey-darker mt-2 px-2 py-2 border focus:outline-none",type:"text",name:"city",ref:s({required:"Required"})}),b.city&&Object(r.jsx)(l.HelperText,{valid:!1,children:b.city.message})]}),Object(r.jsxs)("div",{className:"flex justify-between",children:[Object(r.jsx)(l.Button,{tag:o.a,to:"/cart",layout:"outline",size:"small",children:"Back to cart"}),Object(r.jsx)(l.Button,{type:"submit",size:"small",children:"Proceed"})]})]})]})},b=a(4),j=a.n(b),m=a(12),x=a(6),p=a(109),O=a(110),f=a(8),h=a(20),y=a(30),v=a(10),g=a(24),S=a.n(g),N=a(104),P=function(){var e=Object(h.b)(),t=e.cartData,a=e.cartSubtotal;return Object(r.jsxs)("div",{children:[Object(r.jsx)("h1",{className:"text-xl font-medium",children:"Order Summary"}),null===t||void 0===t?void 0:t.items.map((function(e){return Object(r.jsxs)("div",{className:"flex border-b-2 py-2 space-x-2",children:[Object(r.jsx)("img",{className:"w-2/5",loading:"lazy",decoding:"async",src:e.image_url,alt:e.name}),Object(r.jsxs)("div",{className:"flex flex-col space-y-1",children:[Object(r.jsx)("span",{className:"text-2xl font-semibold",children:e.name}),Object(r.jsx)("span",{className:"text-xl font-medium",children:Object(y.a)(e.price)}),Object(r.jsxs)("span",{className:"",children:["Quantity: ",e.quantity]})]})]},e.product_id)})),Object(r.jsxs)("p",{className:"text-3xl font-semibold text-right p-2",children:["Total: ",Object(y.a)(a)]})]})},k=a(19),T=a(111),_=function(e){var t=e.isProcessing,a=e.setIsProcessing,n=Object(h.b)(),s=n.cartSubtotal,c=n.cartTotal,d=n.cartData,o=n.setCartData,u=Object(i.b)().userData,b=Object(v.g)(),j=function(e){N.a.createOrder(s,c,e.reference,"PAYSTACK").then((function(){o(Object(m.a)(Object(m.a)({},d),{},{items:[]})),a(!1),b.push({pathname:"/cart/success",state:{fromPaymentPage:!0}})}))},x=function(){k.b.error("Payment cancelled"),a(!1)},p={email:u.email,amount:(100*s).toFixed(2),publicKey:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PAYSTACK_PUB_KEY},O=Object(T.a)(p);return Object(r.jsx)(l.Button,{disabled:t,className:"w-full",onClick:function(){a(!0),O(j,x)},children:t?"Processing...":"Pay with Paystack"})},w=function(e){var t=e.previousStep,a=e.addressData,s=(e.nextStep,Object(h.b)()),i=s.cartSubtotal,d=s.cartTotal,o=s.cartData,u=s.setCartData,b=Object(c.useState)(),g=Object(n.a)(b,2),k=g[0],T=g[1],w=Object(c.useState)(!1),E=Object(n.a)(w,2),C=E[0],D=E[1],R=Object(O.a)(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_STRIPE_PUB_KEY),A=Object(v.g)(),q=function(){var e=Object(x.a)(j.a.mark((function e(t,r,n){var s,c,l,b,x,O,h,y,v;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),T(),s=a.fullname,c=a.email,l=a.address,b=a.city,x=a.state,n&&r){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,D(!0),e.next=9,f.a.post("/payment",{amount:(100*i).toFixed(),email:c});case 9:return O=e.sent,h=O.data,y=r.getElement(p.CardElement),e.next=14,n.createPaymentMethod({type:"card",card:y,billing_details:{name:s,email:c,address:{city:b,line1:l,state:x,country:"NG"}}});case 14:return(v=e.sent).error&&T(v.error),e.next=18,n.confirmCardPayment(h.client_secret,{payment_method:v.paymentMethod.id});case 18:N.a.createOrder(i,d,h.id,"STRIPE").then((function(){u(Object(m.a)(Object(m.a)({},o),{},{items:[]})),D(!1),A.push({pathname:"/cart/success",state:{fromPaymentPage:!0}})})),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(5),D(!1);case 24:case"end":return e.stop()}}),e,null,[[5,21]])})));return function(t,a,r){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"w-full md:w-1/2",children:[Object(r.jsx)("h1",{className:"text-3xl font-semibold text-center mb-2",children:"Checkout"}),Object(r.jsx)(P,{}),Object(r.jsx)("h1",{className:"font-medium text-2xl",children:"Pay with Stripe"}),Object(r.jsx)(p.Elements,{stripe:R,children:Object(r.jsx)(p.ElementsConsumer,{children:function(e){var a=e.stripe,n=e.elements;return Object(r.jsxs)("form",{onSubmit:function(e){return q(e,n,a)},children:[Object(r.jsx)(p.CardElement,{className:"border py-2"}),k&&Object(r.jsx)(l.HelperText,{valid:!1,children:k.message}),Object(r.jsxs)("div",{className:"flex justify-between py-4",children:[Object(r.jsx)(l.Button,{onClick:t,layout:"outline",size:"small",children:"Back"}),Object(r.jsx)(l.Button,{disabled:!a||C,type:"submit",size:"small",children:C||!a?Object(r.jsx)(S.a,{size:10,color:"#0a138b"}):"Pay ".concat(Object(y.a)(i))})]})]})}})}),Object(r.jsx)(_,{isProcessing:C,setIsProcessing:D})]})};t.default=function(){var e=Object(c.useState)(0),t=Object(n.a)(e,2),a=t[0],l=t[1],i=Object(c.useState)(),d=Object(n.a)(i,2),o=d[0],b=d[1],j=Object(v.h)().state,m=Object(v.g)(),x=Object(h.b)().cartData;Object(c.useEffect)((function(){return(null===j||void 0===j?void 0:j.fromCartPage)?0===x.items.length?m.push("/cart"):void 0:m.push("/cart")}),[x,m,j]);var p=function(){return l((function(e){return l(e+1)}))};return Object(r.jsx)(s.a,{children:Object(r.jsx)("div",{className:"flex flex-col justify-center items-center mt-10",children:0===a?Object(r.jsx)(u,{next:function(e){b(e),p()}}):Object(r.jsx)(w,{nextStep:p,previousStep:function(){return l((function(e){return l(e-1)}))},addressData:o})})})}}}]);
//# sourceMappingURL=6.4fa78636.chunk.js.map