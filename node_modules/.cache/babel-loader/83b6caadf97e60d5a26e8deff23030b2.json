{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/xiaxiaoyu/Desktop/javascript/PHONE_STORE_FE/src/context/UserContext.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport API from \"api/axios.config\";\nimport WithAxios from \"helpers/WithAxios\";\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport authService from \"services/auth.service\";\nconst UserContext = /*#__PURE__*/createContext();\n\nconst UserProvider = ({\n  children\n}) => {\n  _s();\n\n  const [userData, setUserData] = useState(null);\n  const [authData, setAuthData] = useState({\n    token: \"\"\n  });\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  useEffect(() => {\n    if (isLoggedIn) {\n      authService.getCurrentUser().then(res => setUserData(res === null || res === void 0 ? void 0 : res.data));\n    }\n  }, [isLoggedIn]);\n  useEffect(() => {\n    if (localStorage.getItem(\"token\")) {\n      setIsLoggedIn(true);\n      setAuthData(JSON.parse(localStorage.getItem(\"token\")));\n    }\n  }, []);\n\n  const updateUserData = async ({\n    fullname,\n    email,\n    username,\n    address,\n    city,\n    state,\n    country,\n    business\n  }) => {\n    const res = await API.put(`/users/${userData.user_id}`, {\n      fullname,\n      email,\n      username,\n      address,\n      city,\n      state,\n      country,\n      business\n    });\n    setUserData(res.data);\n  };\n\n  const setUserInfo = data => {\n    const {\n      user,\n      token\n    } = data;\n    setIsLoggedIn(true);\n    setUserData(user);\n    setAuthData({\n      token\n    });\n    localStorage.setItem(\"token\", JSON.stringify(token));\n  };\n\n  const logout = () => {\n    setUserData(null);\n    setAuthData(null);\n    setIsLoggedIn(false);\n    authService.logout();\n  };\n\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      userData,\n      setUserData,\n      setUserState: data => setUserInfo(data),\n      logout,\n      isLoggedIn,\n      setIsLoggedIn,\n      authData,\n      setAuthData,\n      updateUserData\n    },\n    children: /*#__PURE__*/_jsxDEV(WithAxios, {\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 3\n  }, this);\n};\n\n_s(UserProvider, \"pHdkOfFBMbl8V/GG3egTLhFuq2o=\");\n\n_c = UserProvider;\n\nconst useUser = () => {\n  _s2();\n\n  const context = useContext(UserContext);\n\n  if (context === undefined) {\n    throw new Error(\"useUser must be used within UserProvider\");\n  }\n\n  return context;\n};\n\n_s2(useUser, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n\nexport { UserProvider, useUser };\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"sources":["/Users/xiaxiaoyu/Desktop/javascript/PHONE_STORE_FE/src/context/UserContext.jsx"],"names":["API","WithAxios","React","createContext","useContext","useEffect","useState","authService","UserContext","UserProvider","children","userData","setUserData","authData","setAuthData","token","isLoggedIn","setIsLoggedIn","getCurrentUser","then","res","data","localStorage","getItem","JSON","parse","updateUserData","fullname","email","username","address","city","state","country","business","put","user_id","setUserInfo","user","setItem","stringify","logout","setUserState","useUser","context","undefined","Error"],"mappings":";;;;;;AAAA,OAAOA,GAAP,MAAgB,kBAAhB;AACA,OAAOC,SAAP,MAAsB,mBAAtB;AACA,OAAOC,KAAP,IAAgBC,aAAhB,EAA+BC,UAA/B,EAA2CC,SAA3C,EAAsDC,QAAtD,QAAsE,OAAtE;AACA,OAAOC,WAAP,MAAwB,uBAAxB;AAEA,MAAMC,WAAW,gBAAGL,aAAa,EAAjC;;AAEA,MAAMM,YAAY,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAkB;AAAA;;AACtC,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BN,QAAQ,CAAC,IAAD,CAAxC;AACA,QAAM,CAACO,QAAD,EAAWC,WAAX,IAA0BR,QAAQ,CAAC;AACxCS,IAAAA,KAAK,EAAE;AADiC,GAAD,CAAxC;AAGA,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BX,QAAQ,CAAC,KAAD,CAA5C;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACf,QAAIW,UAAJ,EAAgB;AACfT,MAAAA,WAAW,CAACW,cAAZ,GAA6BC,IAA7B,CAAmCC,GAAD,IAASR,WAAW,CAACQ,GAAD,aAACA,GAAD,uBAACA,GAAG,CAAEC,IAAN,CAAtD;AACA;AACD,GAJQ,EAIN,CAACL,UAAD,CAJM,CAAT;AAMAX,EAAAA,SAAS,CAAC,MAAM;AACf,QAAIiB,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAJ,EAAmC;AAClCN,MAAAA,aAAa,CAAC,IAAD,CAAb;AACAH,MAAAA,WAAW,CAACU,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAX,CAAD,CAAX;AACA;AACD,GALQ,EAKN,EALM,CAAT;;AAOA,QAAMG,cAAc,GAAG,OAAO;AAC7BC,IAAAA,QAD6B;AAE7BC,IAAAA,KAF6B;AAG7BC,IAAAA,QAH6B;AAI7BC,IAAAA,OAJ6B;AAK7BC,IAAAA,IAL6B;AAM7BC,IAAAA,KAN6B;AAO7BC,IAAAA,OAP6B;AAQ7BC,IAAAA;AAR6B,GAAP,KASjB;AACL,UAAMd,GAAG,GAAG,MAAMpB,GAAG,CAACmC,GAAJ,CAAS,UAASxB,QAAQ,CAACyB,OAAQ,EAAnC,EAAsC;AACvDT,MAAAA,QADuD;AAEvDC,MAAAA,KAFuD;AAGvDC,MAAAA,QAHuD;AAIvDC,MAAAA,OAJuD;AAKvDC,MAAAA,IALuD;AAMvDC,MAAAA,KANuD;AAOvDC,MAAAA,OAPuD;AAQvDC,MAAAA;AARuD,KAAtC,CAAlB;AAUAtB,IAAAA,WAAW,CAACQ,GAAG,CAACC,IAAL,CAAX;AACA,GArBD;;AAuBA,QAAMgB,WAAW,GAAIhB,IAAD,IAAU;AAC7B,UAAM;AAAEiB,MAAAA,IAAF;AAAQvB,MAAAA;AAAR,QAAkBM,IAAxB;AACAJ,IAAAA,aAAa,CAAC,IAAD,CAAb;AACAL,IAAAA,WAAW,CAAC0B,IAAD,CAAX;AACAxB,IAAAA,WAAW,CAAC;AACXC,MAAAA;AADW,KAAD,CAAX;AAGAO,IAAAA,YAAY,CAACiB,OAAb,CAAqB,OAArB,EAA8Bf,IAAI,CAACgB,SAAL,CAAezB,KAAf,CAA9B;AACA,GARD;;AAUA,QAAM0B,MAAM,GAAG,MAAM;AACpB7B,IAAAA,WAAW,CAAC,IAAD,CAAX;AACAE,IAAAA,WAAW,CAAC,IAAD,CAAX;AACAG,IAAAA,aAAa,CAAC,KAAD,CAAb;AACAV,IAAAA,WAAW,CAACkC,MAAZ;AACA,GALD;;AAOA,sBACC,QAAC,WAAD,CAAa,QAAb;AACC,IAAA,KAAK,EAAE;AACN9B,MAAAA,QADM;AAENC,MAAAA,WAFM;AAGN8B,MAAAA,YAAY,EAAGrB,IAAD,IAAUgB,WAAW,CAAChB,IAAD,CAH7B;AAINoB,MAAAA,MAJM;AAKNzB,MAAAA,UALM;AAMNC,MAAAA,aANM;AAONJ,MAAAA,QAPM;AAQNC,MAAAA,WARM;AASNY,MAAAA;AATM,KADR;AAAA,2BAaC,QAAC,SAAD;AAAA,gBAAYhB;AAAZ;AAAA;AAAA;AAAA;AAAA;AAbD;AAAA;AAAA;AAAA;AAAA,UADD;AAiBA,CA7ED;;GAAMD,Y;;KAAAA,Y;;AA+EN,MAAMkC,OAAO,GAAG,MAAM;AAAA;;AACrB,QAAMC,OAAO,GAAGxC,UAAU,CAACI,WAAD,CAA1B;;AAEA,MAAIoC,OAAO,KAAKC,SAAhB,EAA2B;AAC1B,UAAM,IAAIC,KAAJ,CAAU,0CAAV,CAAN;AACA;;AACD,SAAOF,OAAP;AACA,CAPD;;IAAMD,O;;AASN,SAASlC,YAAT,EAAuBkC,OAAvB","sourcesContent":["import API from \"api/axios.config\";\r\nimport WithAxios from \"helpers/WithAxios\";\r\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\r\nimport authService from \"services/auth.service\";\r\n\r\nconst UserContext = createContext();\r\n\r\nconst UserProvider = ({ children }) => {\r\n\tconst [userData, setUserData] = useState(null);\r\n\tconst [authData, setAuthData] = useState({\r\n\t\ttoken: \"\",\r\n\t});\r\n\tconst [isLoggedIn, setIsLoggedIn] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isLoggedIn) {\r\n\t\t\tauthService.getCurrentUser().then((res) => setUserData(res?.data));\r\n\t\t}\r\n\t}, [isLoggedIn]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (localStorage.getItem(\"token\")) {\r\n\t\t\tsetIsLoggedIn(true);\r\n\t\t\tsetAuthData(JSON.parse(localStorage.getItem(\"token\")));\r\n\t\t}\r\n\t}, []);\r\n\r\n\tconst updateUserData = async ({\r\n\t\tfullname,\r\n\t\temail,\r\n\t\tusername,\r\n\t\taddress,\r\n\t\tcity,\r\n\t\tstate,\r\n\t\tcountry,\r\n\t\tbusiness,\r\n\t}) => {\r\n\t\tconst res = await API.put(`/users/${userData.user_id}`, {\r\n\t\t\tfullname,\r\n\t\t\temail,\r\n\t\t\tusername,\r\n\t\t\taddress,\r\n\t\t\tcity,\r\n\t\t\tstate,\r\n\t\t\tcountry,\r\n\t\t\tbusiness,\r\n\t\t});\r\n\t\tsetUserData(res.data);\r\n\t};\r\n\r\n\tconst setUserInfo = (data) => {\r\n\t\tconst { user, token } = data;\r\n\t\tsetIsLoggedIn(true);\r\n\t\tsetUserData(user);\r\n\t\tsetAuthData({\r\n\t\t\ttoken,\r\n\t\t});\r\n\t\tlocalStorage.setItem(\"token\", JSON.stringify(token));\r\n\t};\r\n\r\n\tconst logout = () => {\r\n\t\tsetUserData(null);\r\n\t\tsetAuthData(null);\r\n\t\tsetIsLoggedIn(false);\r\n\t\tauthService.logout();\r\n\t};\r\n\r\n\treturn (\r\n\t\t<UserContext.Provider\r\n\t\t\tvalue={{\r\n\t\t\t\tuserData,\r\n\t\t\t\tsetUserData,\r\n\t\t\t\tsetUserState: (data) => setUserInfo(data),\r\n\t\t\t\tlogout,\r\n\t\t\t\tisLoggedIn,\r\n\t\t\t\tsetIsLoggedIn,\r\n\t\t\t\tauthData,\r\n\t\t\t\tsetAuthData,\r\n\t\t\t\tupdateUserData,\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<WithAxios>{children}</WithAxios>\r\n\t\t</UserContext.Provider>\r\n\t);\r\n};\r\n\r\nconst useUser = () => {\r\n\tconst context = useContext(UserContext);\r\n\r\n\tif (context === undefined) {\r\n\t\tthrow new Error(\"useUser must be used within UserProvider\");\r\n\t}\r\n\treturn context;\r\n};\r\n\r\nexport { UserProvider, useUser };\r\n"]},"metadata":{},"sourceType":"module"}