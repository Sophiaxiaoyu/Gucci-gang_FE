{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport ListState from './list-state';\nimport { isEqual } from '@antv/util';\nimport { TOOLTIP_CSS_CONST } from '@antv/component';\nimport { HtmlTooltip } from '../../../dependents';\nvar STATUS_SHOW = 'showRadio';\nvar TIP_ID = 'legend-radio-tip';\n\nvar ListRadio =\n/** @class */\nfunction (_super) {\n  __extends(ListRadio, _super);\n\n  function ListRadio() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.timeStamp = 0;\n    return _this;\n  }\n\n  ListRadio.prototype.show = function () {\n    var triggerInfo = this.getTriggerListInfo();\n\n    if (triggerInfo === null || triggerInfo === void 0 ? void 0 : triggerInfo.item) {\n      var list = triggerInfo.list,\n          item = triggerInfo.item;\n      list.setItemState(item, STATUS_SHOW, true);\n    }\n  };\n\n  ListRadio.prototype.hide = function () {\n    var triggerInfo = this.getTriggerListInfo();\n\n    if (triggerInfo === null || triggerInfo === void 0 ? void 0 : triggerInfo.item) {\n      var list = triggerInfo.list,\n          item = triggerInfo.item;\n      list.setItemState(item, STATUS_SHOW, false);\n    }\n  };\n\n  ListRadio.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this.tooltip && this.tooltip.destroy();\n  };\n  /**\n   * 显示 Tooltip (展示在上方)\n   * @returns\n   */\n\n\n  ListRadio.prototype.showTip = function () {\n    var context = this.context;\n    var ev = context.event;\n    var lastTimeStamp = this.timeStamp;\n    var timeStamp = +new Date();\n    var target = this.context.event.target;\n\n    if (timeStamp - lastTimeStamp > 16 && target.get('name') === 'legend-item-radio') {\n      var preLoc = this.location;\n      var curLoc = {\n        x: ev.x,\n        y: ev.y\n      };\n      this.timeStamp = timeStamp;\n      this.location = curLoc;\n\n      if (!preLoc || !isEqual(preLoc, curLoc)) {\n        this.showTooltip(curLoc);\n      }\n    }\n  };\n  /**\n   * 隐藏 Tooltip。\n   * @returns\n   */\n\n\n  ListRadio.prototype.hideTip = function () {\n    this.hideTooltip();\n    this.location = null;\n  };\n\n  ListRadio.prototype.showTooltip = function (curLoc) {\n    var context = this.context;\n    var ev = context.event;\n    var target = ev.target;\n\n    if (target && target.get('tip')) {\n      if (!this.tooltip) {\n        this.renderTooltip(); // 延迟生成\n      } // 展示 tooltip\n\n\n      var _a = context.view.getCanvas().get('el').getBoundingClientRect(),\n          offsetX = _a.x,\n          offsetY = _a.y;\n\n      this.tooltip.update(__assign(__assign({\n        title: target.get('tip')\n      }, curLoc), {\n        x: curLoc.x + offsetX,\n        y: curLoc.y + offsetY\n      }));\n      this.tooltip.show();\n    }\n  };\n\n  ListRadio.prototype.hideTooltip = function () {\n    this.tooltip && this.tooltip.hide();\n  };\n\n  ListRadio.prototype.renderTooltip = function () {\n    var _a;\n\n    var tooltipStyles = (_a = {}, _a[TOOLTIP_CSS_CONST.CONTAINER_CLASS] = {\n      padding: '6px 8px',\n      transform: 'translate(-50%, -80%)',\n      background: 'rgba(0,0,0,0.75)',\n      color: '#fff',\n      'border-radius': '2px',\n      // 避免遮挡，如果还不够的话，再考虑开放用户配置\n      'z-index': 100\n    }, _a[TOOLTIP_CSS_CONST.TITLE_CLASS] = {\n      'font-size': '12px',\n      'line-height': '14px',\n      'margin-bottom': 0,\n      'word-break': 'break-all'\n    }, _a);\n\n    if (document.getElementById(TIP_ID)) {\n      document.body.removeChild(document.getElementById(TIP_ID));\n    }\n\n    var tooltip = new HtmlTooltip({\n      parent: document.body,\n      // tooltip 限制的区域\n      region: null,\n      visible: false,\n      crosshairs: null,\n      domStyles: tooltipStyles,\n      containerId: TIP_ID\n    });\n    tooltip.init();\n    tooltip.setCapture(false); // 不允许捕获事件\n\n    this.tooltip = tooltip;\n  };\n\n  return ListRadio;\n}(ListState);\n\nexport default ListRadio;","map":{"version":3,"sources":["../../../../src/interaction/action/component/list-radio.ts"],"names":[],"mappings":"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","sourcesContent":["import ListState from './list-state';\nimport { isEqual } from '@antv/util';\nimport { TOOLTIP_CSS_CONST } from '@antv/component';\nimport { HtmlTooltip } from '../../../dependents';\nimport { Point } from '../../../interface';\n\nconst STATUS_SHOW = 'showRadio';\nconst TIP_ID = 'legend-radio-tip';\n\nclass ListRadio extends ListState {\n  public show() {\n    const triggerInfo = this.getTriggerListInfo();\n    if (triggerInfo?.item) {\n      const { list, item } = triggerInfo;\n      list.setItemState(item, STATUS_SHOW, true);\n    }\n  }\n\n  public hide() {\n    const triggerInfo = this.getTriggerListInfo();\n    if (triggerInfo?.item) {\n      const { list, item } = triggerInfo;\n      list.setItemState(item, STATUS_SHOW, false);\n    }\n  }\n\n  private timeStamp: number = 0;\n  private location: Point;\n  private tooltip;\n\n  public destroy() {\n    super.destroy();\n    this.tooltip && this.tooltip.destroy();\n  }\n\n  /**\n   * 显示 Tooltip (展示在上方)\n   * @returns\n   */\n  public showTip() {\n    const context = this.context;\n    const ev = context.event;\n    const lastTimeStamp = this.timeStamp;\n    const timeStamp = +new Date();\n\n    const target = this.context.event.target;\n    if (timeStamp - lastTimeStamp > 16 && target.get('name') === 'legend-item-radio') {\n      const preLoc = this.location;\n      const curLoc = { x: ev.x, y: ev.y };\n      this.timeStamp = timeStamp;\n      this.location = curLoc;      \n      if (!preLoc || !isEqual(preLoc, curLoc)) {\n        this.showTooltip(curLoc);\n      }\n    }\n  }\n\n  /**\n   * 隐藏 Tooltip。\n   * @returns\n   */\n  public hideTip() {\n    this.hideTooltip();\n    this.location = null;\n  }\n\n  protected showTooltip(curLoc: Point) {\n    const context = this.context;\n    const ev = context.event;\n    const target = ev.target;\n\n    if (target && target.get('tip')) {\n      if (!this.tooltip) {\n        this.renderTooltip(); // 延迟生成\n      }\n      // 展示 tooltip\n      const { x: offsetX, y: offsetY } = context.view.getCanvas().get('el').getBoundingClientRect();\n      this.tooltip.update({\n        title: target.get('tip'),\n        ...curLoc,\n        x: curLoc.x + offsetX,\n        y: curLoc.y + offsetY,\n      });\n      this.tooltip.show();\n    }\n  }\n\n  protected hideTooltip() {\n    this.tooltip && this.tooltip.hide();\n  }\n\n  private renderTooltip() {\n    const tooltipStyles = {\n      [TOOLTIP_CSS_CONST.CONTAINER_CLASS]: {\n        padding: '6px 8px',\n        transform: 'translate(-50%, -80%)',\n        background: 'rgba(0,0,0,0.75)',\n        color: '#fff',\n        'border-radius': '2px',\n        // 避免遮挡，如果还不够的话，再考虑开放用户配置\n        'z-index': 100,\n      },\n      [TOOLTIP_CSS_CONST.TITLE_CLASS]: {\n        'font-size': '12px',\n        'line-height': '14px',\n        'margin-bottom': 0,\n        'word-break': 'break-all',\n      }\n    };\n    if (document.getElementById(TIP_ID)) {\n      document.body.removeChild(document.getElementById(TIP_ID));\n    }\n    const tooltip = new HtmlTooltip({\n      parent: document.body,\n      // tooltip 限制的区域\n      region: null,\n      visible: false,\n      crosshairs: null,\n      domStyles: tooltipStyles,\n      containerId: TIP_ID,\n    });\n    tooltip.init();\n    tooltip.setCapture(false); // 不允许捕获事件\n    this.tooltip = tooltip;\n  }\n}\n\nexport default ListRadio;\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}